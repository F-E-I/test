// leanModal v1.1 by Ray Stone - http://finelysliced.com.au
// Dual licensed under the MIT and GPL

(function($) {
	$.fn.extend({
		leanModal : function(options) {
			var defaults = {
				modal_id : null,
				top : 100,
				overlay : 0.5,
				closeButton : null
			};
			var overlay = $("<div id='lean_overlay'></div>");
			$("body").append(overlay);
			options = $.extend(defaults, options);
			return this.each(function() {
				var o = options;
				$(this).click(function(e) {
					var $modal = $("#" + o.modal_id);
					$("#lean_overlay").click(function() {
						close_modal($modal)
					});
					$(o.closeButton).click(function() {
						close_modal($modal)
					});
					var modal_height = $modal.outerHeight();
					var modal_width = $modal.outerWidth();
					$("#main").css({
						"position" : "fixed"
					});
					$("#lean_overlay").css({
						"display" : "block",
						opacity : 0
					});
					$("#lean_overlay").fadeTo(200, o.overlay);
					$modal.css({
						"display" : "block",
						"opacity" : 0,
						"z-index" : 110,
						"left" : 50 + "%",
						"margin-left" : -(modal_width / 2) + "px",
						"top" : o.top + "px"
					});
					$modal.fadeTo(200, 1);
					e.preventDefault()
				})
			});
			function close_modal($modal) {
				$("#lean_overlay").fadeOut(200);
				$modal.css({
					"display" : "none"
				})
				$("#main").css({
					"position" : "absolute"
				});
			}
		}
	})
})(jQuery);
